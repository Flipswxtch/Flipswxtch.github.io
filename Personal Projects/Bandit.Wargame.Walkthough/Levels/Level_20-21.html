<!DOCTYPE html>
<html>

<head>
    <title>Bandit Walkthrough: Level 20→21</title>
    <link rel="stylesheet" href="style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="UTF-8">
    <meta name="author" content="Kevin Kennedy">
    <meta name="description" content="OverTheWire: Bandit-Wargame Level 20 to 21 Walkthrough">
</head>

<body>
    <div class="alwaysontop">
        <header class="topbanner">
            OverTheWire.org Walkthrough: Bandit
        </header>
    </div>
    <div class="maincontent">
        <div class="sidemenu">
            <ul>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\index.html">Home</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_0-0.html">Level: 0</li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_0-1.html">Level: 0&#8594;1</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_1-2.html">Level: 1&#8594;2</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_2-3.html">Level: 2&#8594;3</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_3-4.html">Level: 3&#8594;4</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_4-5.html">Level: 4&#8594;5</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_5-6.html">Level: 5&#8594;6</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_6-7.html">Level: 6&#8594;7</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_7-8.html">Level: 7&#8594;8</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_8-9.html">Level: 8&#8594;9</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_9-10.html">Level: 9&#8594;10</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_10-11.html">Level: 10&#8594;11</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_11-12.html">Level: 11&#8594;12</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_12-13.html">Level: 12&#8594;13</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_13-14.html">Level: 13&#8594;14</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_14-15.html">Level: 14&#8594;15</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_15-16.html">Level: 15&#8594;16</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_16-17.html">Level: 16&#8594;17</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_17-18.html">Level: 17&#8594;18</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_18-19.html">Level: 18&#8594;19</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_19-20.html">Level: 19&#8594;20</a></li>
                <li>Level: 20&#8594;21</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_21-22.html">Level: 21&#8594;22</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_22-23.html">Level: 22&#8594;23</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_23-24.html">Level: 23&#8594;24</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_24-25.html">Level: 24&#8594;25</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_25-26.html">Level: 25&#8594;26</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_26-27.html">Level: 26&#8594;27</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_27-28.html">Level: 27&#8594;28</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_28-29.html">Level: 28&#8594;29</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_29-30.html">Level: 29&#8594;30</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_30-31.html">Level: 30&#8594;31</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_31-32.html">Level: 31&#8594;32</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_32-33.html">Level: 32&#8594;33</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_33-34.html">Level: 33&#8594;34</a></li>
            </ul>
        </div>
        <div class="allbodycontent">
            <h1 class="levelnumber">~ Level 20&#8594;21 ~</h1>
            <h2 class="bodysectiontitle">Level Description</h2>
            <div class="leveldescription">
                <p>
                    There is a setuid binary in the homedirectory that does the following: it makes a connection to localhost on the port you 
                    specify as a commandline argument. It then reads a line of text from the connection and compares it to the password in the previous level (bandit20). If the password is correct, it will transmit the password for the next level (bandit21).
                </p>
                <p>
                    NOTE: Try connecting to your own network daemon to see if it works as you think
                </p>
                <p>
                    The following are commands that may be required to solve the level: <b>ssh, nc, cat, bash, screen, tmux,</b> and <b>Unix ‘job control’ (bg, fg, jobs, &, CTRL-Z, …)</b>
                </p>
                <hr class="linebreak">
            </div>
            <h2 class="bodysectiontitle">Research Before Solving</h2>
            <div class="research">
                <p>
                    The <b class="command">screen</b> command will be used for this level. This command is used to have multiple command line sessions open within 
                    the same window. More on this when we use it.
                </p>
                <hr class="linebreak">
            </div>
            <h2 class="bodysectiontitle">Solution Walkthrough</h2>
            <div class="solution">
                <p>
                    As usual, log in to the server, this time as <b>bandit20</b>. We will first use <b class="command">ls</b> to list files in the 
                    <b class="directory">home</b> directory. We find a file by the name of <b>suconnect</b>. Note it's color of red, an indication of escalated priveleges.
                    This means we are able to execute the file using <b class="command">./suconnect</b>
                </p>
                <img src="\Personal Projects\Bandit.Wargame.Walkthough\Images\Level_20_21_pics\suconnect.png"
                alt="executing suconnect file" class="largepicture">
                <p>
                    We are given <b class="command">nc</b> as a command to solve the level, we are also advised by the executable file that the program will connect to a given port 
                    that is set up on the <b>localhost</b>. This is where <b class="command">tmux</b> comes in. We must set up two prompt sessions, one will be used to listen while the other 
                    will be used to execute <b>suconnect</b>.
                </p>
                <p>
                Type in the command <b class="command">tmux</b>, you should see a <q>new window</q> open within your ssh client. We will now use the command of <b class="command">$tmux</b>
                to force open a second instance. We can swap between the two instances by pressing <b>ctrl+b</b> simultaneously with an immediate follow up
                of <b>shift+9</b> or <b>shift+0</b>. You should see session instances change in the bottom.   
                </p>
                <p>
                    In one instance we will type <b class="command">echo GbKksEFF4yrVs6il55v6gwY5aVje5f0j | nc -l -p 55000</b> to echo last level's password and then open a port and start listening on it. 
                    We can now switch to our other instance using <b>ctrl+b</b> followed by 
                    <b>shift+0</b> and execute the file in the <b class="directory">home</b> directory making sure to use the same port as we did in the first instance: <b class="command">./suconnect 55000</b>
                </p>
                <img src="\Personal Projects\Bandit.Wargame.Walkthough\Images\Level_20_21_pics\sending_pass.png"
                alt="executable states it's sending password" class="largepicture">
                <img src="\Personal Projects\Bandit.Wargame.Walkthough\Images\Level_20_21_pics\echo_nc.png"
                alt="password for bandit21" class="largepicture">
                <p>
                    As can be seen, one instance confirms the passwords match and that the password for <b>bandit21</b> is being sent. Swapping to our other instance 
                    shows the password for the next level. Congratulations!
                </p>
                <p>
                    Password: <b class="password">gE269g2h3mw3pwgrj0Ha9Uoqen1c9DGr</b>
                </p>
            </div>
            <div>
                <div class="previous">
                    <a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_19-20.html">Previous Level</a>
                </div>
                <div class="next">
                    <a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_21-22.html">Next Level</a>
                </div>
                <footer>
                    <div class="footerinfo">
                        <p>Author: Kevin Kennedy</p>
                        <p>Creation: December 15th, 2020 - December 27th, 2020</p>
                    </div>
                </footer>
            </div>
        </div>
    </div>
</body>

</html>