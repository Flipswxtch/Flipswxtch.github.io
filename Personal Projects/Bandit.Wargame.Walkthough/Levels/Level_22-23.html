<!DOCTYPE html>
<html>

<head>
    <title>Bandit Walkthrough: Level 22→23</title>
    <link rel="stylesheet" href="style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="UTF-8">
    <meta name="author" content="Kevin Kennedy">
    <meta name="description" content="OverTheWire: Bandit-Wargame Level 22 to 23 Walkthrough">
</head>

<body>
    <div class="alwaysontop">
        <header class="topbanner">
            OverTheWire.org Walkthrough: Bandit
        </header>
    </div>
    <div class="maincontent">
        <div class="sidemenu">
            <ul>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\index.html">Home</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_0-0.html">Level: 0</li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_0-1.html">Level: 0&#8594;1</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_1-2.html">Level: 1&#8594;2</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_2-3.html">Level: 2&#8594;3</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_3-4.html">Level: 3&#8594;4</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_4-5.html">Level: 4&#8594;5</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_5-6.html">Level: 5&#8594;6</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_6-7.html">Level: 6&#8594;7</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_7-8.html">Level: 7&#8594;8</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_8-9.html">Level: 8&#8594;9</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_9-10.html">Level: 9&#8594;10</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_10-11.html">Level: 10&#8594;11</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_11-12.html">Level: 11&#8594;12</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_12-13.html">Level: 12&#8594;13</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_13-14.html">Level: 13&#8594;14</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_14-15.html">Level: 14&#8594;15</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_15-16.html">Level: 15&#8594;16</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_16-17.html">Level: 16&#8594;17</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_17-18.html">Level: 17&#8594;18</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_18-19.html">Level: 18&#8594;19</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_19-20.html">Level: 19&#8594;20</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_20-21.html">Level: 20&#8594;21</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_21-22.html">Level: 21&#8594;22</a></li>
                <li>Level: 22&#8594;23</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_23-24.html">Level: 23&#8594;24</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_24-25.html">Level: 24&#8594;25</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_25-26.html">Level: 25&#8594;26</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_26-27.html">Level: 26&#8594;27</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_27-28.html">Level: 27&#8594;28</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_28-29.html">Level: 28&#8594;29</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_29-30.html">Level: 29&#8594;30</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_30-31.html">Level: 30&#8594;31</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_31-32.html">Level: 31&#8594;32</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_32-33.html">Level: 32&#8594;33</a></li>
                <li><a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_33-34.html">Level: 33&#8594;34</a></li>
            </ul>
        </div>
        <div class="allbodycontent">
            <h1 class="levelnumber">~ Level 22&#8594;23 ~</h1>
            <h2 class="bodysectiontitle">Level Description</h2>
            <div class="leveldescription">
                <p>
                    A program is running automatically at regular intervals from <b>cron</b>, the time-based job scheduler. Look in <b>/etc/cron.d/</b> for
                    the configuration and see what command is being executed.
                </p>
                <p>
                    <b>NOTE:</b> Looking at shell scripts written by other people is a very useful skill. The script for this level is intentionally made easy to read. 
                    If you are having problems understanding what it does, try executing it to see the debug information it prints.
                </p>
                <p>
                    Commands that may be needed: <b>cron, crontab,</b> and <b>crontab(5) (use “man 5 crontab” to access this)</b>
                </p>
                <hr class="linebreak">
            </div>
            <h2 class="bodysectiontitle">Research Before Solving</h2>
            <div class="research">
                <p>
                    Research will be done as we go through the level!
                </p>
                <hr class="linebreak">
            </div>
            <h2 class="bodysectiontitle">Solution Walkthrough</h2>
            <div class="solution">
                <p>
                    If you haven't already, log in to the OverTheWire server as <b>bandit22</b>. According to the description, we need to 
                    navigate to the <b class="directory">/tmp/cron.d/</b> directory. Once there, we will use <b class="command">ls</b> again to list the
                    files.
                </p>
                <img src="\Personal Projects\Bandit.Wargame.Walkthough\Images\Level_22_23_pics\cat_crond.png"
                alt="cat /tmp/cron.d directory" class="largepicture">
                <p>
                    Just as we did last time, <b class="command">cat</b> the file related to the next level: <b>cronjob_bandit23</b>.
                </p>
                <img src="\Personal Projects\Bandit.Wargame.Walkthough\Images\Level_22_23_pics\cat_cronjob.png"
                alt="contents of cronjob_bandit23 file" class="largepicture">
                <p>
                    We will once again use <b class="command">cat</b> to read the contents of the script we just located.
                </p>
                <img src="\Personal Projects\Bandit.Wargame.Walkthough\Images\Level_22_23_pics\cat_bandit23sh.png"
                alt="contents of cronjob_bandit23.sh" class="largepicture">
                <p>
                    Now comes the time to research. A variable is created called <b>myname</b> and the value of the command <b class="command">whoami</b>
                    is assigned to it. The current user will print out when issuing the <b class="command">whoami</b> command. The script will then create
                    another variable called <b>mytarget</b>. The variable's value is then set by first using an <b class="command">echo</b> command. 
                    This output is piped to the  <b class="command">md5sum</b> command which will create a hash out of it. Lastly, <b class="command">cut</b> 
                    will be used to print this output to the variable. The final piece of the script is saying the password will be put into 
                    a directory named as the hash.
                </p>
                <p>
                    Now that we have this information, we can use part of the script to determine the hash for user <b>bandit23</b>.To do this we will run 
                    <b class="command">echo I am user bandit23 | md5sum | cut -d ' ' -f 1</b>
                </p>
                <img src="\Personal Projects\Bandit.Wargame.Walkthough\Images\Level_22_23_pics\echo_md5sum.png"
                alt="hash of aforementioned command" class="largepicture">
                <p>
                    We've mimicked the hash that's used as the file name. To locate the password we will use the following command: <b class="command">cat /tmp/8ca319486bfbbc3663ea0fbe81326349</b>
                </p>
                <img src="\Personal Projects\Bandit.Wargame.Walkthough\Images\Level_22_23_pics\password.png"
                alt="password for bandit23" class="largepicture">
                <p>
                    We've found the password for the next level: <b class="password">jc1udXuA1tiHqjIsL8yaapX5XIAI6i0n</b>! 
                </p>
            </div>
            <div>
                <div class="previous">
                    <a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_21-22.html">Previous Level</a>
                </div>
                <div class="next">
                    <a href="\Personal Projects\Bandit.Wargame.Walkthough\Levels\Level_23-24.html">Next Level</a>
                </div>
                <footer>
                    <div class="footerinfo">
                        <p>Author: Kevin Kennedy</p>
                        <p>Creation: December 15th, 2020 - December 27th, 2020</p>
                    </div>
                </footer>
            </div>
        </div>
    </div>
</body>

</html>